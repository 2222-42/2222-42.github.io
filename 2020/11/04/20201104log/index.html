<!doctype html><html lang=jp><head><meta charset=utf-8><title>20201104log</title><meta name=description content="2222-42's weblog"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://2222-42.github.io/index.xml title="Que Lock Si Jeus Nee"><link id=dark-mode-theme rel=stylesheet href=https://2222-42.github.io/css/dark.css><link rel=stylesheet href=https://2222-42.github.io/fontawesome/css/all.min.css><script src=https://2222-42.github.io/js/bundle.js></script><script src=https://2222-42.github.io/js/instantpage.js type=module defer></script><meta name=generator content="Hugo 0.74.3"><meta property="og:title" content="20201104log"><meta property="og:description" content="昨日の予想通り体調が崩れた。"><meta property="og:type" content="article"><meta property="og:url" content="https://2222-42.github.io/2020/11/04/20201104log/"><meta property="og:image" content="https://2222-42.github.io/myIcon.jpg"><meta property="article:published_time" content="2020-11-04T10:01:12+00:00"><meta property="article:modified_time" content="2020-11-04T10:01:12+00:00"><meta property="og:site_name" content="Que Lock Si Jeus Nee"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://2222-42.github.io/myIcon.jpg"><meta name=twitter:title content="20201104log"><meta name=twitter:description content="昨日の予想通り体調が崩れた。"></head><body><header><nav class=navbar><div class=nav><a href=https://2222-42.github.io/ class=nav-logo><img src=https://2222-42.github.io/images/myIcon.jpg width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/about/ name=About><i class="fas fa-user fa-lg"></i></a></li><li><a href=/tags/ name=Tags><i class="fas fa-tag fa-lg"></i></a></li><li><a href=/search/ name=Search><i class="fas fa-search fa-lg"></i></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>20201104log</h1><span class=meta-post><i class="fa fa-calendar-alt"></i>&nbsp;Nov 4, 2020</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><p>昨日の予想通り体調が崩れた。</p><h1 id=diary>diary</h1><p>昨日、夜まで仕事して、お酒も飲んでしまったので、日課が崩れて、今日の体調も崩れた。</p><h2 id=vacant>vacant</h2><p>虚無な一日を送ってしまった。</p><p>昨晩、薬を飲み忘れ、朝も薬を飲み忘れて、何もできなかった。</p><p>ご飯食べて寝るという生活をまた送ってしまった。</p><p>休息は日常生活において重要な役割をはたしているが、それでもなお、虚無な一日を送ることはつらさがある。</p><h3 id=ecs>ecs</h3><p>朝起きたら、無限再起動ではなく、無限タスク起動が起きていたことが判明した。</p><p>次回の出社で修正する。</p><h2 id=dream>dream</h2><p>夢の記録</p><ul><li>部屋の隅で蜘蛛が巣を張っている。</li><li>黒と紅。コントラストがキレイ。</li><li>蜘蛛がたまごを抱えている。</li><li>親の腹を子供たちが食す。</li></ul><h1 id=今日の勉強>今日の勉強</h1><h2 id=rust>rust</h2><p>TRPL</p><ul><li>pp. 65-68</li><li>文字列リテラルが不変であるから、中身がコンパイル時にわかっているから、バイナリに直接ハードコードされ、高速で効率的になる。</li><li>サイズが不明・可変なら、テキスト片用に一塊のメモリを<strong>バイナリに</strong>確保するのは不可能</li><li>String型は、<strong>コンパイル時に</strong>不明な、メモリを<strong>ヒープに</strong>確保して内容を保持する<ul><li>メモリは<strong>実行時に</strong>OSに要求する(<code>String::from</code>)</li><li>String型を使用し終わったら、OSに個のメモリを返す方法が必要<ul><li>GCがある言語なら、使用していないメモリを自動で解放</li><li>GCがない言語では、明示的に返還するコードを呼び出すのはプログラマの仕事<ul><li>これの難しいところ:<ul><li>返還忘れで、メモリの無駄な使用</li><li>返還が早くて、無効な変数を生成</li><li>返還を二回して、バグを生み出す</li></ul></li></ul></li><li>Rustが歩む道は、所有権<ul><li>メモリを所有している変数がスコープを抜けたら(ここが自然な地点)、メモリを自動的に返還する<ul><li>スコープを抜けたところで、<code>drop</code>関数という特別な関数が呼ばれる</li></ul></li><li>ヒープ上に確保されたデータを複数の変数に使用されるような、もっと複雑な場面でコードの振る舞いは予期しないものになる可能性がある</li></ul></li></ul></li></ul></li><li>複数の変数が同じデータに対して、異なる手段で、相互作用する<ul><li>不変な場合、整数などの既知の固定サイズの単純な値の場合は問題にならない<ul><li>スタック上に保持されているので、変数のコピーを作成することは、スタックのデータをコピーしている。</li></ul></li><li><code>String::from</code>で生成されたものは3つの部品で構成されており、それはスタック上に保持されている。<ul><li><code>ptr</code>: 文字列の中身を保持するメモリへのポインタ<ul><li>その中身はヒープ上に保持されえている。</li></ul></li><li><code>len</code>: 現在使用しているメモリ量をバイトで表す「長さ」</li><li><code>capacity</code>: OSから受け取った全メモリ量をバイトで表す「許容量」</li></ul></li><li><code>String</code>型の変数をコピーすることは、スタック上のデータのコピーをしており、ヒープ上のデータをコピーしない</li><li>問題点<ul><li>変数がスコープを抜けると、Rustは自動的に、その変数が使っているヒープメモリを開放する</li><li>スタック上のデータをコピーした変数、両方は、同じヒープメモリを見ている。</li><li>両方の変数がスコープを抜けると、2重解放が発生するのでは？<ul><li>2重解放の問題は、memory coruptionを産み、脆弱性を産む可能性がある</li><li>(<code>move</code>の話につながっていく)</li></ul></li></ul></li></ul></li></ul><div class=blog-tags><a href=https://2222-42.github.io//tags/rust/>rust</a>&nbsp;
<a href=https://2222-42.github.io//tags/ecs/>ecs</a>&nbsp;
<a href=https://2222-42.github.io//tags/vacant/>vacant</a>&nbsp;
<a href=https://2222-42.github.io//tags/dream/>dream</a>&nbsp;</div></article></div><footer><div><a href=https://twitter.com/9_6_42 name=twitter><em class="fab fa-twitter"></em></a><a href=https://github.com/2222-42 name=github><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://2222-42.github.io/about>2222-42</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://2222-42.github.io/>Que Lock Si Jeus Nee</a>
&nbsp;&ndash;&nbsp;
<i class="fas fa-moon" id=dark-mode-toggle></i><p class="credits theme-by"><a href=https://gohugo.io>Hugo</a>&nbsp;
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></p></div></footer></body></html>